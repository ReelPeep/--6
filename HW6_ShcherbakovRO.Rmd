# Домашнее задание 6

Тема: расчет выборки при планировании исследования.

Цель: научиться рассчитывать выборку для исследований с различными конечными точками.

## Описание ДЗ

При выполнении этого домашнего задания вам необходимо посчитать выборки для различных типов точек. Напишите соответствующий код, пользуясь указанными формулами.

Пусть наш спонсор заинтересован, чтобы исследование имело 80% мощность, а уровень значимости — 5%, ожидаемый drop-out rate = 10%.

### 1.(3 балла)
Рассчитайте выборку для исследования терапевтической эквивалентности для двухпериодного cross-over дизайна. Из предыдущих исследований известно, что дисперсия составляет 20% ( = 0.20), а разница средних составляет −10% (). Клиницисты сообщают нам, что клинически значимая разница составляет 25% ( = 0.25).

```{r}
# Мощность
power <- 0.80
# Уровень значимости
alpha <- 0.05
# Drop-out rate
dropout_rate <- 0.1

```


```{r}
#Дисперсия
sd <- 0.2
#Разница средних
eps <- -0.1
#Клинически значимая разница
delta <- 0.25
```

```{r}

#Размер выборки
z_alpha_2 <- qnorm(1 - alpha/2)
z_beta <- qnorm(power)
n <- ((z_alpha_2 + z_beta)^2 * (sd)^2) / (2 * (delta - abs(eps))^2)
cat("Размер выборки:", n, "\n")
#Размер выборки с учетом drop-out rate
n <- n / (1 - dropout_rate)
cat("Размер выборки с учетом drop-out rate:", round(n), "\n")
cat("Общий размер выборки", round(n*2))
```
## 2(3 балла)
Рассчитайте выборку для гипотезы non-inferiority для двухвыборочного параллельного дизайна. Пусть клинически значимая разница = -0.1, то есть мы ожидаем разницу не меньше 10%, а долю ответов для тестового препарата = 0.65, в то время как нам известно из предыдущих исследований, что доля ответов у препарата сравнения составляет = 0.85. Соотношение групп равно = 1.

```{r}
#Клинически значимая разница
delta <- -0.1
#Доля ответов для тестового препарат
p2 <- 0.65
#Доля ответов у препарата сравнения
p1 <- 0.85
# Соотношение групп
k <- 1
```


```{r}
n <- ((z_alpha_2 + z_beta)^2 * (p1 * (1 - p1) + p2 * (1 - p2))) / (p1 - p2 - delta)^2
cat("Размер выборки:", n, "\n")

#Размер выборки с учетом drop-out rate
n <- n / (1 - dropout_rate)
cat("Размер выборки с учетом drop-out rate:", round(n), "\n")
cat("Общий размер выборки", round(n*2))
```
## 3 (4 балла)
Рассчитайте выборку для гипотезы equality для следующего исследования. Мы хотим сравнить новую терапию инфекции, присоединяющейся в больничных условиях у пациентов с ожогами, с золотым стандартом, основываясь на данных, анализируемых с помощью регрессии Кокса. Пусть отношение рисков «золотой стандарт / новая терапия», hazard ratio, HR = 2. Мы предполагаем, что 80% пациентов ( = 0.8) могут столкнуться с этим заболеванием. Соотношения групп терапии равны ().


```{r}
#Соотношение рисков
HR <- 2
#процент пациентов
d <- 0.8
p1 <- 0.5
p2 <- 0.5

n <- ((z_alpha_2 + z_beta)^2) / ((log(HR)^2) * p1 * p2 * d)
cat("Размер выборки:", n, "\n")

#Размер выборки с учетом drop-out rate
n <- n / (1 - dropout_rate)
cat("Размер выборки с учетом drop-out rate:", round(n), "\n")
cat("Общий размер выборки", round(n*2))
```


















